

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Application Layer &mdash; M17 Protocol Specification  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Recommendation for the codeplug structure" href="codeplug.html" />
    <link rel="prev" title="Data Link Layer" href="data_link_layer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> M17 Protocol Specification
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Part I - Air and IP Interface:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="summary.html">M17 RF Protocol: Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="physical_layer.html">Physical Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_link_layer.html">Data Link Layer</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Application Layer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#packet-superframes">Packet Superframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#encryption-types">Encryption Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#null-encryption">Null Encryption</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scrambler">Scrambler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-encryption-standard-aes">Advanced Encryption Standard (AES)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Part II - Codeplug:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="codeplug.html">Recommendation for the codeplug structure</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendix:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="address_encoding.html">Address Encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="decorrelator.html">Decorrelator sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="interleaving.html">Interleaving</a></li>
<li class="toctree-l1"><a class="reference internal" href="ip_encapsulation.html">M17 Internet Protocol (IP) Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="kiss_protocol.html">KISS Protocol</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">M17 Protocol Specification</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Application Layer</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/application_layer.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="application-layer">
<h1>Application Layer<a class="headerlink" href="#application-layer" title="Permalink to this headline">¶</a></h1>
<p>PARTS 1 AND 2 REMOVED – will add this later.</p>
<div class="section" id="packet-superframes">
<span id="id1"></span><h2>Packet Superframes<a class="headerlink" href="#packet-superframes" title="Permalink to this headline">¶</a></h2>
<p>Packet superframes are composed of a 1..n byte data type specifier, 0..797 bytes of
payload data.  The data type specifier is encoded in the same way as UTF-8.  It provides
efficient coding of common data types.  And it can be extended to include a very large
number of distinct packet data type codes.</p>
<p>The data type specifier can also be used as a protocol specifier.  For example,
the following protocol identifers are reserved in the M17 packet spec:</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-number">Table 17 </span><span class="caption-text">Reserved Protocols</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Identifer</p></th>
<th class="head"><p>Protocol</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x00</p></td>
<td><p>RAW</p></td>
</tr>
<tr class="row-odd"><td><p>0x01</p></td>
<td><p>AX.25</p></td>
</tr>
<tr class="row-even"><td><p>0x02</p></td>
<td><p>APRS</p></td>
</tr>
<tr class="row-odd"><td><p>0x03</p></td>
<td><p>6LoWPAN</p></td>
</tr>
<tr class="row-even"><td><p>0x04</p></td>
<td><p>IPv4</p></td>
</tr>
<tr class="row-odd"><td><p>0x05</p></td>
<td><p>SMS</p></td>
</tr>
<tr class="row-even"><td><p>0x06</p></td>
<td><p>WinLink</p></td>
</tr>
</tbody>
</table>
<p>The data type specifier is used to compute the CRC, along with the payload.</p>
</div>
<div class="section" id="encryption-types">
<h2>Encryption Types<a class="headerlink" href="#encryption-types" title="Permalink to this headline">¶</a></h2>
<p>Encryption is optional and disabled by default. The use of it is only
allowed if local laws allow to doso.</p>
<div class="section" id="null-encryption">
<h3>Null Encryption<a class="headerlink" href="#null-encryption" title="Permalink to this headline">¶</a></h3>
<p>Encryption type = <span class="math notranslate nohighlight">\(00_2\)</span></p>
<p>No encryption is performed, payload is sent in clear text.</p>
</div>
<div class="section" id="scrambler">
<h3>Scrambler<a class="headerlink" href="#scrambler" title="Permalink to this headline">¶</a></h3>
<p>Encryption type = <span class="math notranslate nohighlight">\(01_2\)</span></p>
<p>Scrambling is an encryption by bit inversion using a bitwise
exclusive-or (XOR) operation between bit sequence of data and
pseudorandom bit sequence.</p>
<p>Encrypting bitstream is generated using a Fibonacci-topology
Linear-Feedback Shift Register (LFSR).  Three different LFSR sizes are
available: 8, 16 and 24-bit. Each shift register has an associated
polynomial. The polynomials are listed in Table 7. The LFSR is
initialised with a seed value of the same length as the shift
register. Seed value acts as an encryption key for the scrambler
algorithm.  Figures 5 to 8 show block diagrams of the algorithm</p>
<table class="docutils align-default" id="id4">
<caption><span class="caption-number">Table 18 </span><span class="caption-text">LFSR scrambler polynomials</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Encryption subtype</p></th>
<th class="head"><p>LFSR polynomial</p></th>
<th class="head"><p>Seed length</p></th>
<th class="head"><p>Sequence period</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(00_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(x^8 + x^6 + x^5 + x^4 + 1\)</span></p></td>
<td><p>8 bits</p></td>
<td><p>255</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(01_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(x^{16} + x^{15} + x^{13} + x^4 + 1\)</span></p></td>
<td><p>16 bits</p></td>
<td><p>65,535</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(10_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(x^{24} + x^{23} + x^{22} + x^{17} + 1\)</span></p></td>
<td><p>24 bits</p></td>
<td><p>16,777,215</p></td>
</tr>
</tbody>
</table>
<div class="figure align-default" id="id5">
<a class="reference internal image-reference" href="_images/LFSR_8.svg"><img alt="_images/LFSR_8.svg" src="_images/LFSR_8.svg" /></a>
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">8-bit LFSR taps</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id6">
<a class="reference internal image-reference" href="_images/LFSR_16.svg"><img alt="_images/LFSR_16.svg" src="_images/LFSR_16.svg" /></a>
<p class="caption"><span class="caption-number">Fig. 8 </span><span class="caption-text">16-bit LFSR taps</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id7">
<a class="reference internal image-reference" href="_images/LFSR_24.svg"><img alt="_images/LFSR_24.svg" src="_images/LFSR_24.svg" /></a>
<p class="caption"><span class="caption-number">Fig. 9 </span><span class="caption-text">24-bit LFSR taps</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="advanced-encryption-standard-aes">
<h3>Advanced Encryption Standard (AES)<a class="headerlink" href="#advanced-encryption-standard-aes" title="Permalink to this headline">¶</a></h3>
<p>Encryption type = <span class="math notranslate nohighlight">\(10_2\)</span></p>
<p>This method uses AES block cipher in counter (CTR) mode. 96-bit nonce
value is extracted from the NONCE field, as the 96 most significant
bits of it. The highest 16 bits of the counter are the remaining 16
bits of the NONCE field. FN field value is then used as the
counter. The 16 bit frame counter and 40 ms frames can provide for
over 20 minutes of streaming without rolling over the counter <a class="footnote-reference brackets" href="#fn-roll" id="id2">1</a>. This
method adapts 16-bit counter to the standard 32-bit CTR for the
encryption. FN counter always start from 0 (zero).</p>
<dl class="footnote brackets">
<dt class="label" id="fn-roll"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>The effective capacity of the counter is 15 bits, as the
MSB is used for transmission end signalling</p>
</dd>
</dl>
<p>The nonce value should be generated with a hardware random number
generator or any other method of generating non-repeating
values. Nonce values must be used only once. It is obvious that with a
finite number of nonce bits, the probability of nonce collision
approaches 1. We assume that the transmission is secure for 237 frames
using a single key. It is recommended to change keys after that
period.</p>
<p>To combat replay attacks, a 32-bit timestamp shall be embedded into
the NONCE field. The field structure is shown in Table 9. Timestamp is 32 LSB portion of
the number of seconds that elapsed since the beginning of 1970-01-01,
00:00:00 UTC, minus leap seconds (a.k.a. “unix time”).</p>
<table class="docutils align-default" id="id8">
<caption><span class="caption-number">Table 19 </span><span class="caption-text">NONCE field structure</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>TIMESTAMP</p></th>
<th class="head"><p>NONCE</p></th>
<th class="head"><p>CTR_HIGH</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>32</p></td>
<td><p>64</p></td>
<td><p>16</p></td>
</tr>
</tbody>
</table>
<p><strong>CTR_HIGH</strong> field initializes the highest 16 bits of the CTR, with
the rest of the counter being equal to the FN counter.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="codeplug.html" class="btn btn-neutral float-right" title="Recommendation for the codeplug structure" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="data_link_layer.html" class="btn btn-neutral float-left" title="Data Link Layer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Project M17.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>